{"sections":{"main":{"type":"main-product","blocks":{"vendor":{"type":"text","settings":{"text":"","text_style":"uppercase"}},"title":{"type":"title","settings":{}},"price":{"type":"price","settings":{}},"variant_picker":{"type":"variant_picker","settings":{"picker_type":"button","swatch_shape":"circle"}},"custom_liquid_gajkKN":{"type":"custom_liquid","settings":{"custom_liquid":"<style>\n  .file-upload-container {\n    display: flex;\n    align-items: center;\n  }\n\n  .file-name {\n    margin-left: 10px;\n    font-style: italic;\n  }\n\n  .delete-button {\n    margin-left: 10px;\n    background-color: #f44336;\n    color: white;\n    border: none;\n    padding: 5px 10px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 12px;\n    cursor: pointer;\n    border-radius: 4px;\n    vertical-align: middle;\n  }\n\n  .delete-button:hover {\n    background-color: #d32f2f;\n  }\n\n  .disabled-radio {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n<\/style>\n\n<div class=\"product-form__input\">\n  <label class=\"form__label\"><\/label>\n  <div class=\"file-upload-container\">\n    <input id=\"fileInput\" form=\"{{ 'product-form-' | append: section.id }}\" name=\"properties[1]\" multiple\n      style=\"display: none;\" type=\"file\" required \/>\n    <button id=\"uploadButton\" class=\"button\">Last opp bilde(r)<\/button>\n    <p id=\"fileNameDisplay\" class=\"file-name\">Ingen filer valgt<\/p>\n    <button id=\"deleteButton\" class=\"delete-button\" style=\"display: none;\">Slett<\/button>\n  <\/div>\n  <p id=\"errorMessage\" class=\"error-message\" style=\"display: none;margin-top:0;color:red\">Vennligst last opp bilde(r).<\/p>\n  <p id=\"maxFilesError\" class=\"error-message\" style=\"display: none;margin-top:0;color:red\">For mange bilder valgt. Maks antall er:\n    <span id=\"maxFilesCount\">1<\/span><\/p>\n<\/div>\n\n{% comment %} Legg til initial verdi basert på variantvalg {% endcomment %}\n{%- liquid\n  assign max_allowed_files = 1\n  for option in product.options_with_values\n    if option.name contains 'Antall Bilder' or option.name contains 'Antall'\n      assign selected_value = option.selected_value | default: option.values.first\n      assign number_match = selected_value | split: ' ' | first\n      if number_match contains '1' or number_match contains '5' or number_match contains '10' or number_match contains '20'\n        assign max_allowed_files = number_match | plus: 0\n      endif\n    endif\n  endfor\n-%}\n\n<script>\n  document.addEventListener('DOMContentLoaded', function() {\n    let maxAllowedFiles = {{ max_allowed_files }};\n    document.getElementById('maxFilesCount').textContent = maxAllowedFiles;\n    console.log('Initial maks antall filer fra Liquid:', maxAllowedFiles);\n\n    const fileInput = document.getElementById('fileInput');\n    const uploadButton = document.getElementById('uploadButton');\n    const fileNameDisplay = document.getElementById('fileNameDisplay');\n    const deleteButton = document.getElementById('deleteButton');\n    const radioButtons = document.querySelectorAll('input[type=\"radio\"][name*=\"Antall Bilder\"], input[type=\"radio\"][name*=\"Antall-\"], input[type=\"radio\"][name*=\"Antall\"]');\n    const productFormSubmitButton = document.querySelector('.product-form__submit');\n\n    function disableQuantityRadios() {\n      if (radioButtons) {\n        radioButtons.forEach(radio => {\n          radio.disabled = true;\n          radio.classList.add('disabled-radio');\n        });\n      }\n    }\n\n    function enableQuantityRadios() {\n      if (radioButtons) {\n        radioButtons.forEach(radio => {\n          radio.disabled = false;\n          radio.classList.remove('disabled-radio');\n        });\n      }\n    }\n\n    uploadButton.addEventListener('click', function() {\n      fileInput.click();\n    });\n\n    fileInput.addEventListener('change', function(event) {\n      const files = event.target.files;\n      console.log('Antall valgte filer:', files.length, 'Maks tillatt:', maxAllowedFiles);\n\n      if (files.length > maxAllowedFiles) {\n        document.getElementById('maxFilesError').style.display = 'block';\n        this.value = '';\n        fileNameDisplay.textContent = 'Ingen filer valgt';\n        deleteButton.style.display = 'none';\n        enableQuantityRadios(); \/\/ Aktiver radioer igjen hvis for mange filer er valgt\n        return;\n      } else {\n        document.getElementById('maxFilesError').style.display = 'none';\n      }\n\n      if (files.length > 0) {\n        deleteButton.style.display = 'inline-block';\n        disableQuantityRadios(); \/\/ Deaktiver radioer når filer er valgt\n      } else {\n        deleteButton.style.display = 'none';\n        enableQuantityRadios(); \/\/ Aktiver radioer hvis ingen filer er valgt\n      }\n\n      const originalForm = fileInput.getAttribute('form');\n      const fileInputParent = fileInput.parentNode;\n      if (fileInputParent) {\n        fileInputParent.querySelectorAll('.dynamic-hidden-input-').forEach(input => input.remove());\n      }\n\n      for (let i = 0; i < files.length - 1; i++) {\n        const file = files[i];\n        const hiddenInput = document.createElement('input');\n        hiddenInput.type = 'file';\n        let myindex = i + 2;\n        hiddenInput.name = 'properties[ ' + myindex + ']';\n        hiddenInput.classList.add('dynamic-hidden-input-');\n        hiddenInput.classList.add('hidden-input-fileupload');\n        hiddenInput.style.display = 'none';\n        hiddenInput.setAttribute('form', originalForm);\n        const dataTransfer = new DataTransfer();\n        dataTransfer.items.add(file);\n        hiddenInput.files = dataTransfer.files;\n        if (fileInputParent) {\n          fileInputParent.appendChild(hiddenInput);\n        }\n      }\n\n      let fileName;\n      if (files.length === 0) {\n        fileName = 'Ingen filer valgt';\n      } else if (files.length === 1) {\n        fileName = files[0].name;\n        document.getElementById('errorMessage').style.display = 'none';\n      } else {\n        fileName = files.length + ' filer';\n        document.getElementById('errorMessage').style.display = 'none';\n      }\n      fileNameDisplay.textContent = fileName;\n    });\n\n    deleteButton.addEventListener('click', function() {\n      fileInput.value = '';\n      fileNameDisplay.textContent = 'Ingen filer valgt';\n      deleteButton.style.display = 'none';\n      enableQuantityRadios(); \/\/ Aktiver radioer når slett-knappen trykkes\n      const fileInputParent = fileInput.parentNode;\n      if (fileInputParent) {\n        fileInputParent.querySelectorAll('.dynamic-hidden-input-').forEach(input => input.remove());\n      }\n    });\n\n    if (productFormSubmitButton) {\n      productFormSubmitButton.addEventListener('click', function(event) {\n        if (!fileInput.files.length && fileInput.required) {\n          document.getElementById('errorMessage').style.display = 'block';\n          event.preventDefault();\n        }\n      });\n    }\n\n    \/\/ Initial sjekk for radioknapper ved lasting av siden\n    if (radioButtons && radioButtons.length > 0) {\n      const initialRadio = document.querySelector('input[type=\"radio\"][name*=\"Antall\"]:checked');\n      if (initialRadio) {\n        const initialValueMatch = initialRadio.value.match(\/\\d+\/);\n        if (initialValueMatch) {\n          maxAllowedFiles = parseInt(initialValueMatch[0]);\n          document.getElementById('maxFilesCount').textContent = maxAllowedFiles;\n          console.log('Initial maks antall filer fra valgt radio:', maxAllowedFiles);\n        }\n      }\n    } else {\n      console.log('Ingen radioknapper funnet for antall bilder, bruker standardverdi:', maxAllowedFiles);\n    }\n  });\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    const form = document.querySelector(\"form[novalidate]\");\n    if (form) {\n      form.removeAttribute(\"novalidate\");\n    }\n  });\n<\/script>"}},"buy_buttons":{"type":"buy_buttons","settings":{"show_dynamic_checkout":false,"show_gift_card_recipient":true}},"description":{"type":"description","settings":{}}},"block_order":["vendor","title","price","variant_picker","custom_liquid_gajkKN","buy_buttons","description"],"settings":{"enable_sticky_info":true,"color_scheme":"scheme-724eba02-eeda-4a5e-bca5-b6be88a75d66","media_size":"large","constrain_to_viewport":true,"media_fit":"contain","gallery_layout":"stacked","mobile_thumbnails":"hide","media_position":"left","image_zoom":"lightbox","hide_variants":true,"enable_video_looping":false,"padding_top":0,"padding_bottom":0}},"related-products":{"type":"related-products","disabled":true,"settings":{"heading":"You may also like","heading_size":"h1","products_to_show":4,"columns_desktop":4,"columns_mobile":"2","color_scheme":"scheme-1","image_ratio":"portrait","image_shape":"default","show_secondary_image":true,"show_vendor":false,"show_rating":false,"padding_top":56,"padding_bottom":56}}},"order":["main","related-products"]}